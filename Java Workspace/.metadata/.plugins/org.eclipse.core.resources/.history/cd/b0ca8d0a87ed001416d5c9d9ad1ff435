package velinov.java.vrep.objects;

import coppelia.FloatW;
import coppelia.FloatWA;
import coppelia.IntW;
import coppelia.IntWA;
import coppelia.StringWA;
import velinov.java.vrep.VrepClient;
import velinov.java.vrep.VrepConnection;


/**
 * Represents a Shape {@link VrepObject}.
 * 
 * @author Vladimir Velinov
 * @since 27.04.2015
 */
public class Shape extends AbsVrepObject {
  
  /**
   *  texture x-coordinate.
   */
  public static final int POSITION_X = 3006;
  
  int n = 0;

  /**
   * initialize a shape.
   * @param _name
   * @param _client
   */
  public Shape(String _name, VrepClient _client) {
    super(_name, _client);
  }
  
  /**
   * @param _name
   * @param _id
   * @param _client
   */
  public Shape(String _name, IntW _id, VrepClient _client) {
    super(_name, _id, _client);
  }

  @Override
  public void update() {
    this.updatePositionX();
  }
  
  private boolean updatePositionX() {
    
    IntW handle = new IntW(0);
    int  ret;
    
    ret = this.vrepConnection.simxGetObjectHandle(this.client.getClientId(),
        "FinkenDrone0", handle, VrepConnection.simx_opmode_oneshot_wait);
    
    if (ret != VrepConnection.simx_return_ok) {
      //return handle;
    }
 
    FloatW pos = new FloatW(0);
    IntWA hndl = new IntWA(1);
    IntWA intData = new IntWA(1);
    FloatWA floatData = new FloatWA(1);
    StringWA stringData = new StringWA(1);
    
    ret = this.vrepConnection.simxGetObjectGroupData(this.client.getClientId(),
        VrepConnection.sim_object_shape_type, 0, hndl, intData, floatData,
        stringData,  VrepConnection.simx_opmode_oneshot_wait);
    
    float a = floatData.getArray()[15];
    
    System.out.println(a);
    
    /*
    if (this.n == 0) {
      ret = this.vrepConnection.simxGetObjectFloatParameter(
          this.client.getClientId(), handle.getValue(), 3010, pos,
          VrepConnection.simx_opmode_streaming);
    }
    else {
      ret = this.vrepConnection.simxGetObjectFloatParameter(
          this.client.getClientId(), handle.getValue(), 3010, pos,
          VrepConnection.simx_opmode_buffer);
    }
    */
    
    if (ret != VrepConnection.simx_return_ok) {
     // return false;
    }
    
    this.setPositionX(pos.getValue());
    
    return true;
  }

}
